
## 写时拷贝和隐式共享

数据中存放了指向数据的指针和共享计数；
拷贝构造函数使用的是浅拷贝，并且共享计数+1；
修改数据的时候，如果当前的共享计数大于1，则进行一次深拷贝；并将原本的共享计数-1；

有此特性的包括：所有容器类，QString，QByteArray、QBrush、QPen、QPalette、QBitmap、QImage、QPixmap、QCursor、QDir、QFont和QVariant等。




## QList

QList<T>表示为一组指向被存储元素的数组。（例外，如果T本身就是指针类型，或者是size不大于指针类型的基本类型，或者是Qt的共享类，那么QList<T>会直接在指针数组中存储这些元素。）元素个数小于1000的QList能够很快地实现在链表中间插入操作，以及快速的查找操作。此外，由于QList在链表两端都预先分配了内存，因此实现prepend()和append()操作都很快。注意：对于size比指针大的共享类，使用QVector会更好。


## QMap

QMap中的键值对根据key进行了排序，QMap中的key类型必须重载'<'。


### 和QHash的对比

QHash的查找速度明显快于QMap
QHash占用的存储空间明显多于QMap
QHash以任意的方式存储元素
QMap以Key顺序存储元素
QHash的键类型必须提供operator==()和qHash(key)函数
QMap的键类型必须提供operator<()函数

## QString

QString类采用隐式共享计数，将深拷贝和浅拷贝结合起来。

0~20字节，每次分配4个字符空间。
20~4084，分配的内存块大小以2倍的速度增长。
大于4084，每次以2048个字符大小（4096字节，即4KB）的步长增长。





























