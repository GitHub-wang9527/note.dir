## Qt不规则窗口

### 方法1

```cpp
#include <QWidget>
#include <QPixmap>
#include <QPainter>
#include <QMouseEvent>
#include <QBitmap>
#include "ui_anomalyWidget.h"

class anomalyWidget : public QWidget
{
    Q_OBJECT

public:
    anomalyWidget(QWidget *parent = 0)
    {
        ui.setupUi(this);

        //去边框
        setWindowFlags(Qt::FramelessWindowHint|windowFlags());   
        //把窗口背景设置为透明
        setAttribute(Qt::WA_TranslucentBackground);             

        m_pix=QPixmap(":/anomalyWidget/Resources/sunny.png");
        setFixedSize(m_pix.size());
        setMask(m_pix.mask());
    }
    
protected:
    void paintEvent(QPaintEvent *)
    {
        QPainter p(this);
        p.drawPixmap(0, 0, m_pix);
    }

private:
    Ui::anomalyWidgetClass ui;
    QPixmap m_pix;
};

```

### 方法2

```cpp
/*
    构造函数改为如下：
    不需要重写paintEvent
*/
```

```cpp
/* 
    m_pix为不规则窗口的形状
    ui布局中控件距离是透明的
*/
    anomalyWidget(QWidget *parent = 0)
    {
         m_pix=QPixmap(":/anomalyWidget/Resources/sunny.png")
             .scaled(QSize(923,646));
         QLabel *background = new QLabel(this);
         background->setPixmap(m_pix);
         background->setGeometry(0, 0, this->width(), this->height());
         //设置图片充满整个标签
         background->setScaledContents(true);
 
         ui.setupUi(this);
 
         //去边框
         setWindowFlags(Qt::FramelessWindowHint|windowFlags());   
         //把窗口背景设置为透明
         setAttribute(Qt::WA_TranslucentBackground);             
          setMask(m_pix.mask());
    }

      
/* 
    相当于2个简单的不规则窗口拼接成一个复杂的不规则的窗口 
*/
    anomalyWidget(QWidget *parent = 0)
    {
        ui.setupUi(this);
        QPixmap pixL=QPixmap(":/anomalyWidget/Resources/left.png")
            .scaled(QSize(580,646));
        QLabel *bgLabelL = new QLabel(ui.left);
        bgLabelL->setPixmap(pixL);
        bgLabelL->setGeometry(0, 0, pixL.width(), pixL.height());//缺陷，会覆盖掉ui.left上的控件
        QPixmap pixR=QPixmap(":/anomalyWidget/Resources/right.png")
            .scaled(QSize(334,646));
        QLabel *bgLabelR = new QLabel(ui.right);
        bgLabelR->setPixmap(pixR);

        //去边框
        setWindowFlags(Qt::FramelessWindowHint|windowFlags());   
        //把窗口背景设置为透明
        setAttribute(Qt::WA_TranslucentBackground); 
    }
    
    anomalyWidget(QWidget *parent = 0)
    {
        ui.setupUi(this);
        m_pixL=QPixmap(":/anomalyWidget/Resources/left.png")
             .scaled(QSize(580,646));
        m_pixR=QPixmap(":/anomalyWidget/Resources/right.png")
            .scaled(QSize(334,646));

        //去边框
        setWindowFlags(Qt::FramelessWindowHint|windowFlags());
        //把窗口背景设置为透明
         setAttribute(Qt::WA_TranslucentBackground);    

        //setMask(m_pixL.mask());
        ui.left->setMask(m_pixL.mask());
        ui.right->setMask(m_pixR.mask());
        ui.left->setStyleSheet(".QWidget{border-image: url(:/anomalyWidget/Resources/left.png);}");
        ui.right->setStyleSheet(".QWidget{border-image: url(:/anomalyWidget/Resources/right.png);}");
    }

```
