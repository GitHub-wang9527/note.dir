
[TOC]

> 自启服务的尝试，全是在deepin中验证
> deepin的系统不完全支持debian的标准

## 一、deepin启动流程

&emsp;&emsp;1. x11启动显示管理器  
&emsp;&emsp;&emsp;&emsp;根据/etc/X11/default-display-manager中的内容选择显示管理器，比如lightdm、gdm3、KDM

&emsp;&emsp;2. lightdm启动登陆会话
&emsp;&emsp;&emsp;&emsp;根据/etc/lightdm/lightdm.conf中的greeter-session内容，选择登陆会话，比如lightdm-deepin-greeter、lightdm-gtk-greeter

&emsp;&emsp;3. 登录成功后，lightdm拉取一个新的会话
&emsp;&emsp;&emsp;&emsp;/usr/share/xsessions/deepin.desktop中设置startdde作为新的会话

&emsp;&emsp;4. startdde拉取dee-system-daemon dde-dock dde-desktop等dde（deepin desktop environment）组件


## 二、开机自启

#### 1. 添加/etc/init.d/中的rc.local

&emsp;&emsp;尝试失败
        
#### 2. 写一个服务

&emsp;&emsp;[](https://blog.csdn.net/anjing6851/article/details/101466204)

#### 3. 在rc中添加开机自启脚本 服务

> deepin验证成功

&emsp;&emsp;1) 链接rc.local服务文件

```shell
 	sudo ln -fs /lib/systemd/system/rc-local.service /etc/systemd/system/rc-local.service
```

&emsp;&emsp;2) 创建脚本文件并添加内容

```shell
 	touch /etc/rc.local
 	chmod 755 rc.local
 	
 	rc.local的内容如下
 	#!/bin/bash
	echo "test rc!!!" > /var/test_rc.log
```

		
## 三、登陆自启

#### 登陆自启

+ 方法1

&emsp;&emsp;在autostart中添加desktop文件。（标准协议支持）

+ 方法2

&emsp;&emsp;在/etc/profile.d/文件夹中添加sh脚本：/etc/profile会执行/etc/profile.d中的脚本。

&emsp;&emsp;1) 不需要+x权限
&emsp;&emsp;2) 目录可以使用～，根目录也是～
&emsp;&emsp;3) 最好不要启动窗口应用
&emsp;&emsp;&emsp;&emsp;存疑，因为启动控制中心的时候，卡死了图形界面
&emsp;&emsp;&emsp;&emsp;启动启动器，界面显示有点异常
&emsp;&emsp;4) 脚本不是以sudo权限运行的




